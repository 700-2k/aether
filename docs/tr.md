# Техническое решение проекта «Hotel Booking»

## Введение
- **Цель проекта:**  
  Разработать минимально жизнеспособную распределённую систему онлайн‑бронирования номеров в отеле, обеспечивающую корректный учёт доступности и предотвращение «двойной продажи» номера за счёт транзакций/идемпотентности. Система должна позволять искать доступность по датам, создавать временный резерв (hold), подтверждать бронь, отменять и автоматически истекать резервы.

- **Основания для разработки:**  
  Учебный проект по курсу «Распределённые системы».

- **Команда (2 человека):**  
  1) Разработчик Скородумов Владислав.  
  2) Разработчик Никитин Александр. 

---

## Глоссарий
| Термин                                    | Определение                                                                                  |
| ----------------------------------------- | -------------------------------------------------------------------------------------------- |
| **Тип номера (RoomType)**                 | Категория размещения (стандарт/делюкс), вместимость, базовая цена.                           |
| **Инвентарь (Inventory)**                 | Количество доступных единиц по (room_type, дата).                                            |
| **Доступность**                           | Возможность предоставить номер каждого дня в диапазоне проживания.                           |
| **Резерв / Hold**                         | Временная блокировка единицы инвентаря на период проживания; имеет TTL.                      |
| **Бронь / Booking**                       | Подтверждённый результат резерва (после оплаты или ручного подтверждения).                   |
| **Пользователь / Гость**                  | Клиент, оформляющий бронь.                                                                   |
| **TTL**                                   | Время жизни резерва; по истечении — автоматическое освобождение.                             |
| **Идемпотентность**                       | Повтор вызова с одним ключом приводит к одному и тому же эффекту (защита от дублей).         |
| **API Gateway**                           | Входная точка REST/JSON, маршрутизация и валидация запросов.                                 |
| **Сервис бронирования (Booking Service)** | Оркестратор жизненного цикла: create hold → confirm/cancel → expire.                         |
| **Сервис инвентаря (Inventory Service)**  | Хранит и атомарно изменяет остатки инвентаря по датам/типам.                                 |
| **Сообщения/События (optional)**          | Доменные события (HoldCreated/Expired, BookingConfirmed/Canceled) для аналитики/уведомлений. |
| **Outbox (optional)**                     | Паттерн надёжной публикации событий из локальной транзакции.                                 |


---

## Функциональные требования (MVP)
1. **Поиск доступности**: по датам заезда/выезда и параметрам (например количество человек) вернуть доступные типы номеров и цены.  
2. **Создание резерва (Hold)**: заблокировать 1 единицу выбранного типа номера на весь период проживания. Валидация пересечений и остатков обязательна.  
3. **Подтверждение брони**:   переводит резерв в бронь.
4. **Авто‑истечение резерва**: фоновой задачей по TTL освобождать инвентарь и менять статус.  
5. **Отмена**: по запросу клиента отменять активный резерв/бронь.  
6. **Просмотр моих броней**: список и детали по пользователю.  
7. **Администрирование**: CRUD типов номеров и исходной матрицы инвентаря по датам.

---

## Нефункциональные требования
- **Консистентность:** при сбоях — повторение запросов допустимо и безопасно.  
- **Производительность:** поиск доступности ≤ 200 мс при тёплом кэше, создание hold ≤ 300 мс. Объём: до 10k броней/сутки, до 100 типов номеров.  
- **Надёжность:** устойчивость к падению одного сервиса; задачи TTL перезапускаемы; журналирование ошибок и аудита действий бронирования.  
- **Масштабируемость:** горизонтально масштабируем БД.
- **Безопасность:** базовая валидация входных данных.


---

## Пользовательские сценарии

### Сценарий 1. Поиск доступных номеров
1. Пользователь выбирает даты заезда и выезда.  
2. Система показывает список доступных номеров с ценой.  

---

### Сценарий 2. Создание брони
1. Пользователь выбирает номер из списка.  
2. Система временно бронирует номер и сообщает пользователю код брони.  

---

### Сценарий 3. Подтверждение брони
1. Пользователь подтверждает бронь.  
2. Система переводит бронь в статус подтверждённой.  

---

### Сценарий 4. Просмотр броней
1. Пользователь открывает раздел «Мои брони».  
2. Система показывает список всех броней пользователя с их статусами.  

---

### Сценарий 5. Отмена брони
1. Пользователь выбирает бронь и нажимает «Отменить».  
2. Система отменяет бронь и освобождает номер.  


##  Архитектура системы

---

## Технические сценарии

---

## План разработки и тестирования
